# Environment Variables

This application recognizes the following environment variables:

| Name                                      | Description                                                                                                                                                                                                              |             Range/Type             |  Required?   | Default |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :--------------------------------: | :----------: | :-----: |
| `API_PORT`                                | HTTP port that the application listens on                                                                                                                                                                                |            1025 - 65535            |              |  3000   |
| `CAPACITY_LIMIT`                          | Maximum amount of provider capacity this app is allowed to use (per epoch) type: 'percentage' 'amount' value: number (may be percentage, ie '80', or absolute amount of capacity)                                        |  JSON [(example)](./env.template)  |      Y       |         |
|`DEBOUNCE_SECONDS`|Number of seconds to retain pending graph updates in the Redis cache to avoid redundant fetches from the chain|>= 0|||                                                                                                                             |                > 0                 |              |   100   |
| `FREQUENCY_URL`                           | Blockchain node address                                                                                                                                                                                                  |       http(s): or ws(s): URL       |      Y       |         |
| `GRAPH_ENVIRONMENT_DEV_CONFIG`            | [NOTE]: Only used for Dev environments. Add the graph environment config in JSON format only used for Dev environments. Be careful to escape any inner quotes as this is in a .env file and will be parsed by the shell. |  JSON [(example)](./env.template)  | Y (if 'Dev') |         |
| `GRAPH_ENVIRONMENT_TYPE`                  | Graph environment type.                                                                                                                                                                                                  | Mainnet\|TestnetPaseo\|Rococo\|Dev |      Y       |         |
| `PROVIDER_ACCOUNT_SEED_PHRASE`            | Seed phrase for provider MSA control key                                                                                                                                                                                 |               string               |      Y       |         |
| `PROVIDER_ID`                             | Provider MSA ID                                                                                                                                                                                                          |              integer               |      Y       |         |
| `QUEUE_HIGH_WATER`                        | Max number of jobs allowed on the 'graphUpdateQueue' before blockchain scan will be paused to allow queue to drain                                                                                                       |               >= 100               |              |  1000   |
| `REDIS_URL`                               | Connection URL for Redis                                                                                                                                                                                                 |                URL                 |      Y       |
|`RECONNECTION_SERVICE_REQUIRED`|Whether to instantiate/activate reconnection-service features|true/false||

### The following environment variables are only relevant if `RECONNECTION_SERVICE_REQUESTED` is 'true':
| Name                                      | Description                                                                                                                                                                                                              |             Range/Type             |  Required?   | Default |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :--------------------------------: | :----------: | :-----: |
| `PROVIDER_ACCESS_TOKEN`                   | An optional bearer token authentication to the provider webhook                                                                                                                                                          |               string               |              |         |
| `BLOCKCHAIN_SCAN_INTERVAL_MINUTES`        | How many minutes to delay between successive scans of the chain for new accounts (after end of chain is reached)                                                                                                         |                > 0                 |              |   180   |
| `CONNECTIONS_PER_PROVIDER_RESPONSE_PAGE`  | Number of connection/page to request when requesting provider connections from webhook
| `HEALTH_CHECK_MAX_RETRIES`                | Number of `/health` endpoint failures allowed before marking the provider webhook service down                                                                                                                           |                >= 0                |              |   20    |
| `HEALTH_CHECK_MAX_RETRY_INTERVAL_SECONDS` | Number of seconds to retry provider webhook `/health` endpoint when failing                                                                                                                                              |                > 0                 |              |   64    |
| `HEALTH_CHECK_SUCCESS_THRESHOLD`          | Minimum number of consecutive successful calls to the provider webhook `/health` endpoint before it is marked up again                                                                                                   |                > 0                 |              |   10    |
| `PROVIDER_BASE_URL`                       | Base URL for provider webhook endpoints                                                                                                                                                                                  |                URL                 |      Y       |         |
| `WEBHOOK_FAILURE_THRESHOLD`               | Number of failures allowing in the provider webhook before the service is marked down                                                                                                                                    |                > 0                 |              |    3    |
| `WEBHOOK_RETRY_INTERVAL_SECONDS`          | Number of seconds between provider webhook retry attempts when failing                                                                                                                                                   |                > 0                 |              |   10    |
