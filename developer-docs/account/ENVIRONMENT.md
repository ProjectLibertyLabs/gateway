# Environment Variables

ℹ️ Feel free to adjust your environment variables to taste.
This application recognizes the following environment variables:

| Name                                      | Description                                                                                                                                                                       |                                                Range/Type                                                |              Required?               |                     Default                     |
| ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------: | :----------------------------------: | :---------------------------------------------: |
| `API_BODY_JSON_LIMIT`                     | Api json body size limit in string (some examples: 100kb or 5mb or etc)                                                                                                           |                                                  string                                                  |                                      |                       1mb                       |
| `API_PORT`                                | HTTP port that the application listens on                                                                                                                                         |                                               1025 - 65535                                               |                                      |                      3000                       |
| `API_TIMEOUT_MS`                          | Overall API timeout limit in milliseconds. This is the maximum time allowed for any API request to complete. Any `HTTP_RESPONSE_TIMEOUT_MS` value must be less than this value    |                                                   > 0                                                    |                                      |                      30000                      |
| `BLOCKCHAIN_SCAN_INTERVAL_SECONDS`        | How many seconds to delay between successive scans of the chain for new content (after end of chain is reached)                                                                   |                                                   > 0                                                    |                                      |                       12                        |
| `CACHE_KEY_PREFIX`                        | Prefix to use for Redis cache keys                                                                                                                                                |                                                  string                                                  |                  Y                   |                                                 |
| `CAPACITY_LIMIT`                          | Maximum amount of provider capacity this app is allowed to use (per epoch) type: 'percentage' 'amount' value: number (may be percentage, ie '80', or absolute amount of capacity) | JSON [(example)](https://github.com/ProjectLibertyLabs/gateway/blob/main/env-files/account.template.env) |                  Y                   |                                                 |
| `FREQUENCY_API_WS_URL`                    | Blockchain API Websocket URL                                                                                                                                                      |                                                ws(s): URL                                                |                  Y                   |                                                 |
| `FREQUENCY_TIMEOUT_SECS`                  | Frequency chain connection timeout limit; app will terminate if disconnected longer                                                                                               |                                                 integer                                                  |                                      |                       10                        |
| `HEALTH_CHECK_MAX_RETRIES`                | Number of `/health` endpoint failures allowed before marking the provider webhook service down                                                                                    |                                                   >= 0                                                   |                                      |                       20                        |
| `HEALTH_CHECK_MAX_RETRY_INTERVAL_SECONDS` | Number of seconds to retry provider webhook `/health` endpoint when failing                                                                                                       |                                                   > 0                                                    |                                      |                       64                        |
| `HEALTH_CHECK_SUCCESS_THRESHOLD`          | Minimum number of consecutive successful calls to the provider webhook `/health` endpoint before it is marked up again                                                            |                                                   > 0                                                    |                                      |                       10                        |
| `HTTP_RESPONSE_TIMEOUT_MS`                | Timeout in milliseconds to wait for a response as part of a request to an HTTP endpoint. Must be less than `API_TIMEOUT_MS`                                                       |                                         > 0 and < API_TIMEOUT_MS                                         |                                      |                      3000                       |
| `LOG_LEVEL`                               | Verbosity level for logging                                                                                                                                                       |                       `trace` \| `debug` \| `info` \| `warn` \| `error` \| `fatal`                       |                  N                   |                     `info`                      |
| `PRETTY`                                  | Whether logs should be pretty-printed on one line or multiple lines, or plain JSON                                                                                                |                                      `true` \| `false` \| `compact`                                      |                  N                   |                     `false`                     |
| `PROVIDER_ACCESS_TOKEN`                   | An optional bearer token authentication to the provider webhook                                                                                                                   |                                                  string                                                  |                                      |                                                 |
| `PROVIDER_ACCOUNT_SEED_PHRASE`            | Seed phrase or URI or Ethereum private key that is used for provider MSA control key                                                                                              |                                                  string                                                  |                  Y                   |                                                 |
| `PROVIDER_ID`                             | Provider MSA Id                                                                                                                                                                   |                                                 integer                                                  |                  Y                   |                                                 |
| `RATE_LIMIT_TTL`                          | Rate limiting time window in milliseconds. Requests are limited within this time window                                                                                           |                                                   > 0                                                    |                                      |                      60000                      |
| `RATE_LIMIT_MAX_REQUESTS`                 | Maximum number of requests allowed per time window (TTL)                                                                                                                          |                                                   > 0                                                    |                                      |                       100                       |
| `RATE_LIMIT_SKIP_SUCCESS`                 | Whether to skip counting successful requests (2xx status codes) towards the rate limit                                                                                            |                                                 boolean                                                  |                                      |                      false                      |
| `RATE_LIMIT_SKIP_FAILED`                  | Whether to skip counting failed requests (4xx/5xx status codes) towards the rate limit                                                                                            |                                                 boolean                                                  |                                      |                      false                      |
| `RATE_LIMIT_BLOCK_ON_EXCEEDED`            | Whether to block requests when rate limit is exceeded (true) or just log them (false)                                                                                             |                                                 boolean                                                  |                                      |                      true                       |
| `RATE_LIMIT_KEY_PREFIX`                   | Redis key prefix for rate limiting storage. Used to namespace rate limiting data in Redis                                                                                         |                                                  string                                                  |                                      |                account:throttle                 |
| `REDIS_OPTIONS`                           | Additional Redis options.<br/>See [ioredis configuration](https://ioredis.readthedocs.io/en/latest/API/#new-redisport-host-options)                                               |                                               JSON string                                                |   Y<br/>(either this or REDIS_URL)   |           '{"commandTimeout":10000}'            |
| `REDIS_URL`                               | Connection URL for Redis                                                                                                                                                          |                                                   URL                                                    | Y<br/>(either this or REDIS_OPTIONS) |                                                 |
| `SIWF_NODE_RPC_URL`                       | Blockchain node address resolvable from the client browser, used for SIWF                                                                                                         |                                               http(s): URL                                               |                  Y                   |                                                 |
| `SIWF_URL`                                | SIWF v1: URL for Sign In With Frequency V1 UI                                                                                                                                     |                                                   URL                                                    |                                      | https://ProjectLibertyLabs.github.io/siwf/v1/ui |
| `SIWF_V2_URI_VALIDATION`                  | SIWF v2: Domain (formatted as a single URI or JSON array of URIs) to validate signin requests (\*Required if using Sign In with Frequency v2)                                     |             Domain (Example: '["https://www.your-app.com", "example://login", "localhost"]')             |                  \*                  |                                                 |
| `SIWF_V2_URL`                             | SIWF v2: URL for Sign In With Frequency V2 Redirect URL                                                                                                                           |                                                   URL                                                    |                                      |                Frequency Access                 |
| `TRUST_UNFINALIZED_BLOCKS`                | Whether to examine blocks that have not been finalized when tracking extrinsic completion                                                                                         |                                                 boolean                                                  |                                      |                      false                      |
| `VERBOSE_LOGGING`                         | Enable 'verbose' log level                                                                                                                                                        |                                                 boolean                                                  |                  N                   |                      false                      |
| `WEBHOOK_BASE_URL`                        | Base URL for provider webhook endpoints                                                                                                                                           |                                                   URL                                                    |                  Y                   |                                                 |
| `WEBHOOK_FAILURE_THRESHOLD`               | Number of failures allowed in the provider webhook before the service is marked down                                                                                              |                                                   > 0                                                    |                                      |                        3                        |
| `WEBHOOK_RETRY_INTERVAL_SECONDS`          | Number of seconds between provider webhook retry attempts when failing                                                                                                            |                                                   > 0                                                    |                                      |                       10                        |
